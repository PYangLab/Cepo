<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cepo for differential stability analysis of scRNA-seq data • Cepo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cepo for differential stability analysis of scRNA-seq data">
<meta property="og:description" content="Cepo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Cepo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cepo.html">Cepo: a method for differential stability analysis of scRNA-seq data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cepo for differential stability analysis of
scRNA-seq data</h1>
                        <h4 data-toc-skip class="author">Hani Jieun
Kim</h4>
            <address class="author_afil">
      The University of
Sydney<br><a class="author_email" href="mailto:#"></a><a href="mailto:hani.kim127@gmail.com" class="email">hani.kim127@gmail.com</a>
      </address>
                  
            <h4 data-toc-skip class="date">06/24/2024</h4>
      
      
      <div class="hidden name"><code>cepo.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>We introduce <em>Cepo</em>, a method to determine genes governing
cell identity from scRNA-seq data. We propose a biologically motivated
metric—differential stability (DS)—to define cell identity. Our
motivation is driven by the hypothesis that stable gene expression is a
key component of cell identity. This hypothesis implies that genes
marking a cell type should be (i) expressed and (ii) stable in its
expression relative to other cell types. We translate these criteria
into a computational framework where, using predefined cell-type labels,
we compute a cell-type-specific score to prioritise genes that are
differential stably expressed against other cell types between all
cell-type pair comparisons.</p>
<p><em>Cepo</em> is therefore distinct from most methods for
differential analysis (e.g., differential expression) that prioritise
differences in the mean abundance between cell types. <em>Cepo</em> is
able to capture subtle variations in distribution that does not
necessarily involve changes in mean. <em>Cepo</em> is particularly
suitable for large atlas data as it is computationally efficient and
fast. Moreover, <em>Cepo</em> can perform differential stability
analysis for multi-group comparisons in single-cell data.</p>
<p>To access the R code used in the vignettes, type:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span><span class="st">"Cepo"</span><span class="op">)</span></span></code></pre>
<p>Questions relating to <em>Cepo</em> should be reported as a new issue
at <em><a href="https://github.com/PYangLab/Cepo/issues" class="external-link">BugReports</a></em>.</p>
<p>To cite <em>Cepo</em>, type:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"Cepo"</span><span class="op">)</span></span></code></pre>
<div class="section level3">
<h3 id="package-installation">Package installation<a class="anchor" aria-label="anchor" href="#package-installation"></a>
</h3>
<p>The development version of <em>Cepo</em> can be installed with the
following command:</p>
<pre><code><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"Cepo"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="differential-stability-analysis-using-cepo">Differential stability analysis using Cepo<a class="anchor" aria-label="anchor" href="#differential-stability-analysis-using-cepo"></a>
</h2>
<p>The differential stability analysis in <em>Cepo</em> aims to
investigate differential stability patterns between cells of different
cell types. To use <em>Cepo</em> one needs data with cell type labels
(or cluster labels). If no cell-type labels are provided, cells first
need to be clustered and classified in groups via some form of
clustering algorithms. <em>Cepo</em> can then be applied to identify
differentially stable genes between cell types.</p>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>Load the example dataset, a small and randomly sampled subset of the
<a href="https://github.com/LuyiTian/sc_mixology" class="external-link">Cellbench</a> dataset
consisting of 3 cell types 895 cells and 894 genes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Cepo</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cellbench"</span>, package <span class="op">=</span> <span class="st">"Cepo"</span><span class="op">)</span></span>
<span><span class="va">cellbench</span></span></code></pre></div>
<pre><code><span><span class="co">## class: SingleCellExperiment </span></span>
<span><span class="co">## dim: 894 895 </span></span>
<span><span class="co">## metadata(3): scPipe Biomart log.exprs.offset</span></span>
<span><span class="co">## assays(2): counts logcounts</span></span>
<span><span class="co">## rownames(894): AP000902.1 TNNI3 ... SCMH1 IGF2BP2</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(895): CELL_000001 CELL_000003 ... CELL_000955 CELL_000965</span></span>
<span><span class="co">## colData names(17): unaligned aligned_unmapped ... sizeFactor celltype</span></span>
<span><span class="co">## reducedDimNames(0):</span></span>
<span><span class="co">## mainExpName: NULL</span></span>
<span><span class="co">## altExpNames(0):</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cellbench</span> <span class="op">=</span> <span class="va">cellbench</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Columns of the <code>colData</code> indicate the individual id and
various metadata for each cell. <code>colData</code> contains
<code>celltype</code> labels, which will be required to run
<em>Cepo</em>. Differential stability analysis performed on the entire
cell type repertoire.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 5 rows and 17 columns</span></span>
<span><span class="co">##             unaligned aligned_unmapped mapped_to_exon mapped_to_intron</span></span>
<span><span class="co">##             &lt;integer&gt;        &lt;integer&gt;      &lt;integer&gt;        &lt;integer&gt;</span></span>
<span><span class="co">## CELL_000001    167234             8341         526950            40991</span></span>
<span><span class="co">## CELL_000003    174510             8608         513021            42270</span></span>
<span><span class="co">## CELL_000004    158346             7796         504676            39684</span></span>
<span><span class="co">## CELL_000005    159070             6968         486645            38252</span></span>
<span><span class="co">## CELL_000006    144914             8610         465126            33435</span></span>
<span><span class="co">##             ambiguous_mapping mapped_to_ERCC mapped_to_MT number_of_genes</span></span>
<span><span class="co">##                     &lt;integer&gt;      &lt;integer&gt;    &lt;integer&gt;       &lt;numeric&gt;</span></span>
<span><span class="co">## CELL_000001             21392              0        22342           11237</span></span>
<span><span class="co">## CELL_000003             20170              0        20943           11203</span></span>
<span><span class="co">## CELL_000004             18628              0        14021           11237</span></span>
<span><span class="co">## CELL_000005             20029              0        14100           10920</span></span>
<span><span class="co">## CELL_000006             21732              0        11855           11157</span></span>
<span><span class="co">##             total_count_per_cell non_mt_percent non_ribo_percent outliers</span></span>
<span><span class="co">##                        &lt;numeric&gt;      &lt;numeric&gt;        &lt;numeric&gt; &lt;factor&gt;</span></span>
<span><span class="co">## CELL_000001               266880       0.823985         0.797096    FALSE</span></span>
<span><span class="co">## CELL_000003               251204       0.828956         0.801715    FALSE</span></span>
<span><span class="co">## CELL_000004               250040       0.839618         0.816149    FALSE</span></span>
<span><span class="co">## CELL_000005               244441       0.838746         0.798577    FALSE</span></span>
<span><span class="co">## CELL_000006               235288       0.817904         0.788378    FALSE</span></span>
<span><span class="co">##               cell_line cell_line_demuxlet demuxlet_cls sizeFactor    celltype</span></span>
<span><span class="co">##             &lt;character&gt;        &lt;character&gt;  &lt;character&gt;  &lt;numeric&gt; &lt;character&gt;</span></span>
<span><span class="co">## CELL_000001      HCC827             HCC827          SNG    2.15032      HCC827</span></span>
<span><span class="co">## CELL_000003      HCC827             HCC827          SNG    2.00889      HCC827</span></span>
<span><span class="co">## CELL_000004      HCC827             HCC827          SNG    2.06447      HCC827</span></span>
<span><span class="co">## CELL_000005      HCC827             HCC827          SNG    1.92110      HCC827</span></span>
<span><span class="co">## CELL_000006       H1975              H1975          SNG    1.92716       H1975</span></span></code></pre>
<p>Note that, if cell-type labels are unknown, we would need to cluster
cells into groups via some clustering algorithm. In the example dataset,
we have 3 cell types, H1975, H2228 and HCC827, all of which are commonly
used cell lines of lung adenocarcinomas.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "HCC827" "H1975"  "H2228"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="run-cepo-to-generate-list-of-cell-identity-genes">Run Cepo to generate list of cell identity genes<a class="anchor" aria-label="anchor" href="#run-cepo-to-generate-list-of-cell-identity-genes"></a>
</h3>
<div class="section level4">
<h4 id="main-arguments-of-cepo">Main arguments of Cepo<a class="anchor" aria-label="anchor" href="#main-arguments-of-cepo"></a>
</h4>
<p>There are two main arguments to <em>Cepo</em>: 1)
<code>exprsMat</code> is the input data, which should be normalized
data, such as counts per million (CPM) or log2-CPM (e.g.,
<code>logcounts</code> as created via
<code><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">scater::logNormCounts</a></code>). 2) <code>cellTypes</code> receives
as input a vector of cell-type labels. Note that the cell-type labels
should be equal in length and ordered the same as the column names in
<code>exprsMat</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res</span> <span class="op">=</span> <span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span>,</span>
<span>              cellType <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span></code></pre></div>
<p>The <code>Cepo</code> function returns a list of two elements by
default. The first element is a <code>DataFrame</code> of DS statistics.
In this <code>DataFrame</code>, each column corresponds to the DS
statistics for that celltype across all genes. A higher DS statistic
value denotes a gene that is more prioritized as a differentially stable
gene in that given cell type. In the output DataFrame, the columns
correspond to each cell type and each row correspond to a gene.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res</span></span></code></pre></div>
<pre><code><span><span class="co">## $stats</span></span>
<span><span class="co">## DataFrame with 889 rows and 3 columns</span></span>
<span><span class="co">##                H1975     H2228    HCC827</span></span>
<span><span class="co">##            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## AC092447.7  0.852809 -0.450000 -0.402809</span></span>
<span><span class="co">## CT45A3      0.834831 -0.408146 -0.426685</span></span>
<span><span class="co">## AL049870.3  0.815309 -0.465169 -0.350140</span></span>
<span><span class="co">## TDRD9       0.753652 -0.440871 -0.312781</span></span>
<span><span class="co">## TNNI3       0.748876 -0.358848 -0.390028</span></span>
<span><span class="co">## ...              ...       ...       ...</span></span>
<span><span class="co">## STK24      -0.655478  0.369663  0.285815</span></span>
<span><span class="co">## CPVL       -0.669382  0.136236  0.533146</span></span>
<span><span class="co">## BBOX1-AS1  -0.674860  0.436657  0.238202</span></span>
<span><span class="co">## COL4A2     -0.689747  0.397331  0.292416</span></span>
<span><span class="co">## KCNK1      -0.700702  0.329916  0.370787</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pvalues</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "Cepo" "list"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h4>
<p>In many cases, it is beneficial to perform filtering of lowly
expressed genes prior to differential analysis. The parameter
<code>exprsPct</code> specifies the threshold for filtering of lowly
expressed genes should be performed. By default, this is set of
<code>NULL</code>. A value between 0 and 1 should be provided. Whilst
there is no set rule to the threshold, we recommend a value between
<code>0.05</code> and <code>0.07</code>, which will keep any genes that
are expressed in 5-7% in at least one cell type, for microfluidic-based
data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res_zprop</span> <span class="op">=</span> <span class="fu">Cepo</span><span class="fu">::</span><span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span>,</span>
<span>                          cellTypes <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span>,</span>
<span>                          exprsPct <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>The parameter <code>logfc</code> specifies minimum log fold-change in
gene expression. A value of <code>0.2</code> will keep any genes that
show at least <code>abs(0.2)</code> log fold change in gene expression
in at least one cell type. By default, this value is
<code>NULL</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res_logfc</span> <span class="op">=</span> <span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span>,</span>
<span>                    cellTypes <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span>,</span>
<span>                    logfc <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><code>Cepo</code> outputs some useful stats, including the number of
genes <code>nrow</code> and gene names <code>rownames</code>. By
checking <code>nrow</code>, we can see that as expected with filtering
the number of genes included in the <code>Cepo</code> run becomes
fewer.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ds_res</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 889</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ds_res_zprop</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 841</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ds_res_logfc</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 853</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="computing-p-values">Computing p-values<a class="anchor" aria-label="anchor" href="#computing-p-values"></a>
</h4>
<p>There are two methods to compute p-values in <code>Cepo</code>. The
fast approach uses normal approximation of the Cepo statistics to
estimate the null distribution. As this only required 100-200 sample
runs of Cepo, it is much quicker, and the default approach, than the
second permutation approach.</p>
<p>The output of running the p-value computation is a
<code>DataFrame</code> of p-values associated with the DS statistics. In
this <code>DataFrame</code>, each column corresponds to the p-values
associated with the DS statistics.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res_pvalues</span> <span class="op">=</span> <span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span>,</span>
<span>                      cellType <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span>, </span>
<span>                      computePvalue <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                      prefilter_pzero <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Prefiltering 235 genes....</span></span></code></pre>
<p>We can visualise the correlation between the Cepo statistics and
-log10 p-values.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">idx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ds_res_pvalues</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">ds_res_pvalues</span><span class="op">$</span><span class="va">stats</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">ds_res_pvalues</span><span class="op">$</span><span class="va">pvalues</span><span class="op">[</span><span class="va">idx</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       main <span class="op">=</span> <span class="va">i</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"rank Cepo statistics"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"rank -log10 p-values"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The permutation approach requires the users to set the
<code>computePvalue</code> argument to a number of bootstrap runs
required (we recommend this to be at least 10000). Each column of the
<code>DataFrame</code> corresponds to the p-values associated with the
DS statistics obtained through bootstrap on the cells.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res_pvalues</span> <span class="op">=</span> <span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span>,</span>
<span>                      cellType <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span>, </span>
<span>                      <span class="co"># we use a low value for demonstration purposes</span></span>
<span>                      computePvalue <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                      computeFastPvalue <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ds_res_pvalues</span></span></code></pre></div>
<pre><code><span><span class="co">## $stats</span></span>
<span><span class="co">## DataFrame with 889 rows and 3 columns</span></span>
<span><span class="co">##                H1975     H2228    HCC827</span></span>
<span><span class="co">##            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## AC092447.7  0.852809 -0.450000 -0.402809</span></span>
<span><span class="co">## CT45A3      0.834831 -0.408146 -0.426685</span></span>
<span><span class="co">## AL049870.3  0.815309 -0.465169 -0.350140</span></span>
<span><span class="co">## TDRD9       0.753652 -0.440871 -0.312781</span></span>
<span><span class="co">## TNNI3       0.748876 -0.358848 -0.390028</span></span>
<span><span class="co">## ...              ...       ...       ...</span></span>
<span><span class="co">## STK24      -0.655478  0.369663  0.285815</span></span>
<span><span class="co">## CPVL       -0.669382  0.136236  0.533146</span></span>
<span><span class="co">## BBOX1-AS1  -0.674860  0.436657  0.238202</span></span>
<span><span class="co">## COL4A2     -0.689747  0.397331  0.292416</span></span>
<span><span class="co">## KCNK1      -0.700702  0.329916  0.370787</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pvalues</span></span>
<span><span class="co">## DataFrame with 889 rows and 3 columns</span></span>
<span><span class="co">##                H1975     H2228    HCC827</span></span>
<span><span class="co">##            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## AC092447.7         0         1         1</span></span>
<span><span class="co">## CT45A3             0         1         1</span></span>
<span><span class="co">## AL049870.3         0         1         1</span></span>
<span><span class="co">## TDRD9              0         1         1</span></span>
<span><span class="co">## TNNI3              0         1         1</span></span>
<span><span class="co">## ...              ...       ...       ...</span></span>
<span><span class="co">## STK24              1         0         0</span></span>
<span><span class="co">## CPVL               1         0         0</span></span>
<span><span class="co">## BBOX1-AS1          1         0         0</span></span>
<span><span class="co">## COL4A2             1         0         0</span></span>
<span><span class="co">## KCNK1              1         0         0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "Cepo" "list"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="visualizing-results">Visualizing results<a class="anchor" aria-label="anchor" href="#visualizing-results"></a>
</h3>
<p>We can visualize the overlap of differential stability genes between
cell types.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/hms-dbmi/UpSetR" class="external-link">UpSetR</a></span><span class="op">)</span></span>
<span><span class="va">res_name</span> <span class="op">=</span> <span class="fu"><a href="../reference/topGenes.html">topGenes</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ds_res</span>, n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UpSetR/man/upset.html" class="external-link">upset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UpSetR/man/fromList.html" class="external-link">fromList</a></span><span class="op">(</span><span class="va">res_name</span><span class="op">)</span>, nsets <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/upset-plot-1.png" width="700"></p>
<p>Density plot of two genes from each cell type.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDensities.html">plotDensities</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cellbench</span>,</span>
<span>              cepoOutput <span class="op">=</span> <span class="va">ds_res</span>,</span>
<span>              nGenes <span class="op">=</span> <span class="fl">2</span>,</span>
<span>              assay <span class="op">=</span> <span class="st">"logcounts"</span>,</span>
<span>              celltypeColumn <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## AC092447.7, CT45A3, HLA-DRB6, AR, CASC9, AC011632.1 will be plotted</span></span></code></pre>
<pre><code><span><span class="co">## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `after_stat(density)` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">Cepo</span> package.</span></span>
<span><span class="co">##   Please report the issue to the authors.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="cepo_files/figure-html/plot-densities-1.png" width="700"></p>
<p>We can also specify the genes to be plotted.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDensities.html">plotDensities</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cellbench</span>,</span>
<span>              cepoOutput <span class="op">=</span> <span class="va">ds_res</span>,</span>
<span>              genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PLTP"</span>, <span class="st">"CPT1C"</span>, <span class="st">"MEG3"</span>, <span class="st">"SYCE1"</span>, <span class="st">"MICOS10P3"</span>, <span class="st">"HOXB7"</span><span class="op">)</span>,</span>
<span>              assay <span class="op">=</span> <span class="st">"logcounts"</span>,</span>
<span>              celltypeColumn <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/plot-densities-genes-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="running-cepo-in-a-pipeline">Running Cepo in a pipeline<a class="anchor" aria-label="anchor" href="#running-cepo-in-a-pipeline"></a>
</h2>
<div class="section level3">
<h3 id="example-data-1">Example data<a class="anchor" aria-label="anchor" href="#example-data-1"></a>
</h3>
<p>We will load an example dataset, a small, randomly subsampled subset
of the human pancreas datasets from the <a href="https://www.pnas.org/content/116/20/9775" class="external-link">scMerge paper</a>
consisting of 3 batches, 2 cell types, 528 cells, and 1358 genes.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sce_pancreas"</span>, package <span class="op">=</span> <span class="st">"Cepo"</span><span class="op">)</span></span>
<span><span class="va">sce_pancreas</span></span></code></pre></div>
<pre><code><span><span class="co">## class: SingleCellExperiment </span></span>
<span><span class="co">## dim: 1403 528 </span></span>
<span><span class="co">## metadata(0):</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames(1403): SCGN SCG5 ... IFITM3 ZFP36L1</span></span>
<span><span class="co">## rowData names(0):</span></span>
<span><span class="co">## colnames(528): human2_lib2.final_cell_0117 human1_lib3.final_cell_0318</span></span>
<span><span class="co">##   ... 9th_C61_S25 9th_C84_S60</span></span>
<span><span class="co">## colData names(2): batch cellTypes</span></span>
<span><span class="co">## reducedDimNames(0):</span></span>
<span><span class="co">## mainExpName: NULL</span></span>
<span><span class="co">## altExpNames(0):</span></span></code></pre>
<p>Given the presences of batches, we will visualize the data for any
batch effect. Clearly these is separation of the data points by
batch.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: scuttle</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: ggplot2</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">=</span> <span class="va">sce_pancreas</span></span>
<span><span class="va">sce</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocSingular/man/runPCA.html" class="external-link">runPCA</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span></span>
<span>  <span class="va">sce</span>, </span>
<span>  colour_by <span class="op">=</span> <span class="st">"cellTypes"</span>, </span>
<span>  shape_by <span class="op">=</span> <span class="st">"batch"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="scmerge-to-remove-batch-effect">scMerge to remove batch effect<a class="anchor" aria-label="anchor" href="#scmerge-to-remove-batch-effect"></a>
</h3>
<p>We can run the analysis on batch corrected data. For this, we can
implement batch correction methods on the data suing batch correction
methods such as scMerge.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SydneyBioX/scMerge" class="external-link">scMerge</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"segList"</span>, package <span class="op">=</span> <span class="st">"scMerge"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">segList</span><span class="op">$</span><span class="va">human</span><span class="op">$</span><span class="va">human_scSEG</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "AAR2"  "AATF"  "ABCF3" "ABHD2" "ABT1"  "ACAP2"</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scMerge/man/scMerge.html" class="external-link">scMerge</a></span><span class="op">(</span></span>
<span>  sce_combine <span class="op">=</span> <span class="va">sce</span>,</span>
<span>  ctl <span class="op">=</span> <span class="va">segList</span><span class="op">$</span><span class="va">human</span><span class="op">$</span><span class="va">human_scSEG</span>,</span>
<span>  kmeansK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="st">"scMerge"</span>,</span>
<span>  cell_type <span class="op">=</span> <span class="va">sce</span><span class="op">$</span><span class="va">cellTypes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Dimension of the replicates mapping matrix: </span></span>
<span><span class="co">## [1] 528   2</span></span></code></pre>
<pre><code><span><span class="co">## Step 2: Performing RUV normalisation. This will take minutes to hours.</span></span></code></pre>
<pre><code><span><span class="co">## scMerge complete!</span></span></code></pre>
<p>Let us visualise the corrected data.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocSingular/man/runPCA.html" class="external-link">runPCA</a></span><span class="op">(</span><span class="va">corrected</span>,</span>
<span>                            exprs_values <span class="op">=</span> <span class="st">"scMerge"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span></span>
<span>  <span class="va">corrected</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"cellTypes"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"batch"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res</span> <span class="op">=</span> <span class="fu">Cepo</span><span class="fu">::</span><span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">corrected</span>, <span class="st">"scMerge"</span><span class="op">)</span>,</span>
<span>              cellType <span class="op">=</span> <span class="va">corrected</span><span class="op">$</span><span class="va">cellTypes</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-cepo-by-batch">Running Cepo by batch<a class="anchor" aria-label="anchor" href="#running-cepo-by-batch"></a>
</h3>
<p>Rather than running <em>Cepo</em> on the corrected values, we can run
the differential analysis independently on individual batches using the
<code>block</code> argument. By default, the <code>block</code> argument
is set to <code>NULL</code>, ignoring batch information. If batches are
present and the data is not corrected for batch effect, ensure you run
the analyses by block.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_res_batches</span> <span class="op">=</span> <span class="fu">Cepo</span><span class="fu">::</span><span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>,</span>
<span>                            cellTypes <span class="op">=</span> <span class="va">sce</span><span class="op">$</span><span class="va">cellTypes</span>,</span>
<span>                            block <span class="op">=</span> <span class="va">sce</span><span class="op">$</span><span class="va">batch</span>,</span>
<span>                            minCelltype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Note that the resulting output in a list of <code>Cepo</code> class
objects where each slot denotes the individual results for the three
batches, as well as the averaged results saved as
<code>average</code>.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ds_res_batches</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "batch 1" "batch 4" "batch 5" "average"</span></span></code></pre>
<p>We can confirm that the <code>Cepo</code> statistics from across
batches demonstrate a strong correlation. The clustered correlation
heatmap below shows that there is high correlation between the scores of
the same cell type across batches.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">idx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">intersect</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ds_res_batches</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combinedRes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ds_res_batches</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span><span class="va">idx</span>,<span class="op">]</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">batches</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ds_res_batches</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ds_res_batches</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cty</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ds_res_batches</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span><span class="op">)</span>, use.name <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">combinedRes</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[.]"</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">combinedRes</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">annot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  batch <span class="op">=</span> <span class="va">batches</span>,</span>
<span>  celltype <span class="op">=</span> <span class="va">cty</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">combinedRes</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pheatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">combinedRes</span><span class="op">)</span>,</span>
<span>                   annotation <span class="op">=</span> <span class="va">annot</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="downstream-analyses-using-cepo-genes">Downstream analyses using Cepo genes<a class="anchor" aria-label="anchor" href="#downstream-analyses-using-cepo-genes"></a>
</h3>
<div class="section level4">
<h4 id="marker-gene-identification-and-visualisation">Marker gene identification and visualisation<a class="anchor" aria-label="anchor" href="#marker-gene-identification-and-visualisation"></a>
</h4>
<p>One of the useful applications of <code>Cepo</code> is to find marker
genes or cell identity genes on clustered data. We can visualise the top
three marker genes for beta and ductal cells on the PCA.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cepo_genes</span> <span class="op">=</span> <span class="fu">Cepo</span><span class="fu">::</span><span class="fu"><a href="../reference/topGenes.html">topGenes</a></span><span class="op">(</span><span class="va">ds_res_batches</span><span class="op">$</span><span class="va">average</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">markersPlot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">cepo_genes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span></span>
<span>  <span class="va">corrected</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="va">gene</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"cellTypes"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">pp</span> <span class="op">=</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">pp</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">markersPlot</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/marker-genes-1.png" width="1440"></p>
</div>
<div class="section level4">
<h4 id="gene-set-enrichment-analysis">Gene set enrichment analysis<a class="anchor" aria-label="anchor" href="#gene-set-enrichment-analysis"></a>
</h4>
<p>We can also perform a plethora of downstream analyses, from gene set
enrichment analyses to deconvolution of bulk RNA-seq, with the cell
identity gene scores generated from the <code>Cepo</code> package. As an
example, we will perform gene set enrichment analysis using the
<code>fgsea</code> and <code>escape</code> package.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">escape</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctlab/fgsea/" class="external-link">fgsea</a></span><span class="op">)</span></span>
<span><span class="va">hallmarkList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/escape/man/getGeneSets.html" class="external-link">getGeneSets</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"Homo sapiens"</span>, </span>
<span>                           library <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fgseaRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fgsea/man/fgsea.html" class="external-link">fgsea</a></span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">hallmarkList</span>, </span>
<span>                  stats    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">ds_res_batches</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">$</span><span class="va">average</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span>,<span class="st">"beta"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                  minSize <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                  maxSize <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.93% of the list).</span></span>
<span><span class="co">## The order of those tied genes will be arbitrary, which may produce unexpected results.</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enriched_beta</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">fgseaRes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span>, <span class="st">"padj"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">enriched_beta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">fgseaRes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span>, <span class="st">"pathway"</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Note the top 5 enriched pathways for <code>beta cells</code>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enriched_beta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       HALLMARK-PANCREAS-BETA-CELLS   HALLMARK-TNFA-SIGNALING-VIA-NFKB </span></span>
<span><span class="co">##                           9.231295                           6.972586 </span></span>
<span><span class="co">## HALLMARK-INTERFERON-GAMMA-RESPONSE           HALLMARK-APICAL-JUNCTION </span></span>
<span><span class="co">##                           5.775918                           2.270796 </span></span>
<span><span class="co">##           HALLMARK-MITOTIC-SPINDLE </span></span>
<span><span class="co">##                           2.185296</span></span></code></pre>
<p>Finally, we can visualise the enrichment using the
<code>plotEnrichment</code> function from the <code>fgsea</code>
package.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/fgsea/man/plotEnrichment.html" class="external-link">plotEnrichment</a></span><span class="op">(</span><span class="va">hallmarkList</span><span class="op">[[</span><span class="st">"HALLMARK-PANCREAS-BETA-CELLS"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">ds_res_batches</span><span class="op">$</span><span class="va">average</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span>, <span class="st">"beta"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"HALLMARK-PANCREAS-BETA-CELLS"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cepo_files/figure-html/unnamed-chunk-14-1.png" width="480"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="running-out-of-memory-computation-with-cepo">Running out-of-memory computation with Cepo<a class="anchor" aria-label="anchor" href="#running-out-of-memory-computation-with-cepo"></a>
</h2>
<p>To facilitate analysis of high-throughput atlas data consisting of
millions of cells, <code>Cepo</code> also enables out-of-memory and
parallel computation.</p>
<p>The <code>Cepo</code> function naturally handles matrices under the
<code>DelayedArray</code> wrapper. Briefly, <code>DelayedArray</code> is
a wrapper around many matrix classes in <code>R</code>, including
<code>matrix</code>, <code>sparseMatrix</code> and
<code>HDF5Array</code>. The last of which allows for out-of-memory
computation, which means the computation is done outside of RAM. This
will inevitably slow down the computational speed, but the major gain in
doing this is that we can perform computations on data much larger than
what our RAM can store at once.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/DelayedArray" class="external-link">DelayedArray</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'Matrix'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:S4Vectors':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: S4Arrays</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: abind</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'S4Arrays'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:abind':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     abind</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     rowsum</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: SparseArray</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'DelayedArray'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     apply, scale, sweep</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/HDF5Array" class="external-link">HDF5Array</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: rhdf5</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'HDF5Array'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:rhdf5':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     h5ls</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/DelayedArray-class.html" class="external-link">DelayedArray</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/realize.html" class="external-link">realize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">cellbench</span><span class="op">)</span>, <span class="st">"HDF5Array"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">da_matrix</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "HDF5Matrix"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "HDF5Array"</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/showtree.html" class="external-link">seed</a></span><span class="op">(</span><span class="va">da_matrix</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "HDF5ArraySeed"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "HDF5Array"</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da_output</span> <span class="op">=</span> <span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="va">da_matrix</span>, cellType <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span></code></pre></div>
<p>Even though out-of-memory computation is slow, one way that we can
speed up the computation is through parallel processing. This requires
some configurations of the <code>DelayedArray</code> package via the
<code>setAutoBPPARAM</code> function. <code>BiocParallel</code> package
uses the <code>MulticoreParam</code> parameter for Linux/Mac and
<code>SnowParam</code> for Windows.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">BPPARAM</span> <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html" class="external-link">MulticoreParam</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">DelayedArray</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/blockApply.html" class="external-link">setAutoBPPARAM</a></span><span class="op">(</span>BPPARAM <span class="op">=</span> <span class="va">BPPARAM</span><span class="op">)</span> <span class="co">## Setting two cores for computation</span></span>
<span></span>
<span><span class="va">da_output_parallel</span> <span class="op">=</span> <span class="fu"><a href="../reference/Cepo.html">Cepo</a></span><span class="op">(</span>exprsMat <span class="op">=</span> <span class="va">da_matrix</span>, cellTypes <span class="op">=</span> <span class="va">cellbench</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DelayedArray</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DelayedArray/man/blockApply.html" class="external-link">setAutoBPPARAM</a></span><span class="op">(</span>BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co">## Revert back to only one core</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] BiocParallel_1.38.0         HDF5Array_1.32.0           </span></span>
<span><span class="co">##  [3] rhdf5_2.48.0                DelayedArray_0.30.1        </span></span>
<span><span class="co">##  [5] SparseArray_1.4.8           S4Arrays_1.4.1             </span></span>
<span><span class="co">##  [7] abind_1.4-5                 Matrix_1.7-0               </span></span>
<span><span class="co">##  [9] fgsea_1.30.0                escape_2.0.0               </span></span>
<span><span class="co">## [11] scMerge_1.20.0              scater_1.32.0              </span></span>
<span><span class="co">## [13] ggplot2_3.5.1               scuttle_1.14.0             </span></span>
<span><span class="co">## [15] UpSetR_1.4.0                SingleCellExperiment_1.26.0</span></span>
<span><span class="co">## [17] SummarizedExperiment_1.34.0 GenomicRanges_1.56.1       </span></span>
<span><span class="co">## [19] GenomeInfoDb_1.40.1         MatrixGenerics_1.16.0      </span></span>
<span><span class="co">## [21] matrixStats_1.3.0           Cepo_1.11.2                </span></span>
<span><span class="co">## [23] GSEABase_1.66.0             graph_1.82.0               </span></span>
<span><span class="co">## [25] annotate_1.82.0             XML_3.99-0.16.1            </span></span>
<span><span class="co">## [27] AnnotationDbi_1.66.0        IRanges_2.38.0             </span></span>
<span><span class="co">## [29] S4Vectors_0.42.0            Biobase_2.64.0             </span></span>
<span><span class="co">## [31] BiocGenerics_0.50.0         BiocStyle_2.32.1           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] fs_1.6.4                  GSVA_1.52.3              </span></span>
<span><span class="co">##   [3] bitops_1.0-7              httr_1.4.7               </span></span>
<span><span class="co">##   [5] RColorBrewer_1.1-3        numDeriv_2016.8-1.1      </span></span>
<span><span class="co">##   [7] tools_4.4.1               backports_1.5.0          </span></span>
<span><span class="co">##   [9] utf8_1.2.4                R6_2.5.1                 </span></span>
<span><span class="co">##  [11] ResidualMatrix_1.14.0     ggdist_3.3.2             </span></span>
<span><span class="co">##  [13] mgcv_1.9-1                rhdf5filters_1.16.0      </span></span>
<span><span class="co">##  [15] sp_2.1-4                  withr_3.0.0              </span></span>
<span><span class="co">##  [17] gridExtra_2.3             progressr_0.14.0         </span></span>
<span><span class="co">##  [19] cli_3.6.3                 textshaping_0.4.0        </span></span>
<span><span class="co">##  [21] labeling_0.4.3            sass_0.4.9               </span></span>
<span><span class="co">##  [23] mvtnorm_1.2-5             robustbase_0.99-2        </span></span>
<span><span class="co">##  [25] ggridges_0.5.6            QuickJSR_1.2.2           </span></span>
<span><span class="co">##  [27] pkgdown_2.0.9             systemfonts_1.1.0        </span></span>
<span><span class="co">##  [29] StanHeaders_2.32.9        foreign_0.8-86           </span></span>
<span><span class="co">##  [31] R.utils_2.12.3            parallelly_1.37.1        </span></span>
<span><span class="co">##  [33] bbmle_1.0.25.1            limma_3.60.3             </span></span>
<span><span class="co">##  [35] rstudioapi_0.16.0         RSQLite_2.3.7            </span></span>
<span><span class="co">##  [37] generics_0.1.3            gtools_3.9.5             </span></span>
<span><span class="co">##  [39] distributional_0.4.0      dplyr_1.1.4              </span></span>
<span><span class="co">##  [41] inline_0.3.19             loo_2.7.0                </span></span>
<span><span class="co">##  [43] ggbeeswarm_0.7.2          fansi_1.0.6              </span></span>
<span><span class="co">##  [45] distr_2.9.3               R.methodsS3_1.8.2        </span></span>
<span><span class="co">##  [47] lifecycle_1.0.4           yaml_2.3.8               </span></span>
<span><span class="co">##  [49] edgeR_4.2.0               cvTools_0.3.3            </span></span>
<span><span class="co">##  [51] gplots_3.1.3.1            grid_4.4.1               </span></span>
<span><span class="co">##  [53] blob_1.2.4                dqrng_0.4.1              </span></span>
<span><span class="co">##  [55] crayon_1.5.3              bdsmatrix_1.3-7          </span></span>
<span><span class="co">##  [57] reldist_1.7-2             densEstBayes_1.0-2.2     </span></span>
<span><span class="co">##  [59] lattice_0.22-6            msigdbr_7.5.1            </span></span>
<span><span class="co">##  [61] beachmat_2.20.0           cowplot_1.1.3            </span></span>
<span><span class="co">##  [63] KEGGREST_1.44.1           magick_2.8.3             </span></span>
<span><span class="co">##  [65] pillar_1.9.0              knitr_1.47               </span></span>
<span><span class="co">##  [67] metapod_1.12.0            rjson_0.2.21             </span></span>
<span><span class="co">##  [69] future.apply_1.11.2       codetools_0.2-20         </span></span>
<span><span class="co">##  [71] fastmatch_1.1-4           glue_1.7.0               </span></span>
<span><span class="co">##  [73] data.table_1.15.4         spam_2.10-0              </span></span>
<span><span class="co">##  [75] vctrs_0.6.5               png_0.1-8                </span></span>
<span><span class="co">##  [77] gtable_0.3.5              cachem_1.1.0             </span></span>
<span><span class="co">##  [79] xfun_0.45                 pheatmap_1.0.12          </span></span>
<span><span class="co">##  [81] statmod_1.5.0             bluster_1.14.0           </span></span>
<span><span class="co">##  [83] nlme_3.1-164              bit64_4.0.5              </span></span>
<span><span class="co">##  [85] rstan_2.32.6              bslib_0.7.0              </span></span>
<span><span class="co">##  [87] irlba_2.3.5.1             vipor_0.4.7              </span></span>
<span><span class="co">##  [89] KernSmooth_2.23-24        rpart_4.1.23             </span></span>
<span><span class="co">##  [91] colorspace_2.1-0          DBI_1.2.3                </span></span>
<span><span class="co">##  [93] Hmisc_5.1-3               nnet_7.3-19              </span></span>
<span><span class="co">##  [95] UCell_2.8.0               tidyselect_1.2.1         </span></span>
<span><span class="co">##  [97] proxyC_0.4.1              bit_4.0.5                </span></span>
<span><span class="co">##  [99] compiler_4.4.1            AUCell_1.26.0            </span></span>
<span><span class="co">## [101] htmlTable_2.4.2           BiocNeighbors_1.22.0     </span></span>
<span><span class="co">## [103] desc_1.4.3                bookdown_0.39            </span></span>
<span><span class="co">## [105] checkmate_2.3.1           scales_1.3.0             </span></span>
<span><span class="co">## [107] caTools_1.18.2            sfsmisc_1.1-18           </span></span>
<span><span class="co">## [109] DEoptimR_1.1-3            stringr_1.5.1            </span></span>
<span><span class="co">## [111] SpatialExperiment_1.14.0  digest_0.6.36            </span></span>
<span><span class="co">## [113] rmarkdown_2.27            XVector_0.44.0           </span></span>
<span><span class="co">## [115] htmltools_0.5.8.1         pkgconfig_2.0.3          </span></span>
<span><span class="co">## [117] base64enc_0.1-3           sparseMatrixStats_1.16.0 </span></span>
<span><span class="co">## [119] highr_0.11                ruv_0.9.7.1              </span></span>
<span><span class="co">## [121] fastmap_1.2.0             rlang_1.1.4              </span></span>
<span><span class="co">## [123] htmlwidgets_1.6.4         UCSC.utils_1.0.0         </span></span>
<span><span class="co">## [125] DelayedMatrixStats_1.26.0 farver_2.1.2             </span></span>
<span><span class="co">## [127] jquerylib_0.1.4           jsonlite_1.8.8           </span></span>
<span><span class="co">## [129] R.oo_1.26.0               BiocSingular_1.20.0      </span></span>
<span><span class="co">## [131] magrittr_2.0.3            Formula_1.2-5            </span></span>
<span><span class="co">## [133] GenomeInfoDbData_1.2.12   dotCall64_1.1-1          </span></span>
<span><span class="co">## [135] patchwork_1.2.0           Rhdf5lib_1.26.0          </span></span>
<span><span class="co">## [137] munsell_0.5.1             Rcpp_1.0.12              </span></span>
<span><span class="co">## [139] babelgene_22.9            viridis_0.6.5            </span></span>
<span><span class="co">## [141] stringi_1.8.4             zlibbioc_1.50.0          </span></span>
<span><span class="co">## [143] MASS_7.3-60.2             plyr_1.8.9               </span></span>
<span><span class="co">## [145] pkgbuild_1.4.4            parallel_4.4.1           </span></span>
<span><span class="co">## [147] M3Drop_1.30.0             listenv_0.9.1            </span></span>
<span><span class="co">## [149] ggrepel_0.9.5             Biostrings_2.72.1        </span></span>
<span><span class="co">## [151] splines_4.4.1             startupmsg_0.9.6.1       </span></span>
<span><span class="co">## [153] locfit_1.5-9.9            igraph_2.0.3             </span></span>
<span><span class="co">## [155] reshape2_1.4.4            ScaledMatrix_1.12.0      </span></span>
<span><span class="co">## [157] rstantools_2.4.0          evaluate_0.24.0          </span></span>
<span><span class="co">## [159] SeuratObject_5.0.2        RcppParallel_5.1.7       </span></span>
<span><span class="co">## [161] scran_1.32.0              BiocManager_1.30.23      </span></span>
<span><span class="co">## [163] batchelor_1.20.0          purrr_1.0.2              </span></span>
<span><span class="co">## [165] future_1.33.2             rsvd_1.0.5               </span></span>
<span><span class="co">## [167] xtable_1.8-4              ggpointdensity_0.1.0     </span></span>
<span><span class="co">## [169] viridisLite_0.4.2         ragg_1.3.2               </span></span>
<span><span class="co">## [171] tibble_3.2.1              memoise_2.0.1            </span></span>
<span><span class="co">## [173] beeswarm_0.4.0            cluster_2.1.6            </span></span>
<span><span class="co">## [175] globals_0.16.3</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hani Jieun Kim, Kevin Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
